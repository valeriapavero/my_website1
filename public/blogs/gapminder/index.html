<!DOCTYPE HTML>
<html>

    <head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="description" content="Your description">
	<meta name="author" content="Valeria">
	<meta name="generator" content="Hugo 0.75.1" />
	<title>Gapminder Revisited &middot; Valeria</title>
	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="/css/main.css"/>
	

	<!-- Custom Fonts -->
	<link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css">

	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
	<link rel="icon" type="image/x-icon" href="/favicon.ico">
	

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="js/ie/html5shiv.js"></script>
	<script src="js/ie/html5shiv.jsrespond.min.js"></script>
	<![endif]-->
</head>

    <body>

    <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
    <header id="header" class="alt">
        <a href="/" class="logo"><strong>Valeria Pavero</strong></a>
        <nav>
            <a href="#menu">Menu</a>
        </nav>
    </header>

<!-- Menu -->
    <nav id="menu">
        <ul class="links">
            
                <li><a href="/">Home</a></li>
            
                <li><a href="/blogs/gapminder">Gapminder Revisited</a></li>
            
                <li><a href="/blogs/COVID19">COVID-19 Death Rates</a></li>
            
                <li><a href="/blogs/resume">Resume</a></li>
            

        </ul>
        <ul class="actions vertical">
            
                <li><a href="/blogs" class="button special fit">Check it out!</a></li>
            
            
                <li><a href="/" class="button fit">Log In</a></li>
            
        </ul>
    </nav>

        <!-- Main -->
            <div id="main" class="alt">

                
                    <section id="one">
                        <div class="inner">
                            <header class="major">
                                <h1>Gapminder Revisited</h1>
                            </header>
                            
                                 <span class="image main"><img src="pic10.jpeg" alt="" /></span>


<div id="gapminder-revisited" class="section level1">
<h1>Load the Gapminder Data Set</h1>
<p>Load the necessary data <a href=" gapminder package. That data frame contains just six columns from the larger [data in Gapminder World](https://www.gapminder.org/data/"> here.</a></p>

<pre class="r"><code># Load data from Gapminder and World Bank Webstats.

hiv &lt;- read_csv(here::here(&#39;data&#39;,&#39;adults_with_hiv_percent_age_15_49.csv&#39;))

life_expectancy &lt;- read_csv(here::here(&#39;data&#39;,&#39;life_expectancy_years.csv&#39;))

indicators &lt;- c(&#39;SP.DYN.TFRT.IN&#39;,&#39;SE.PRM.NENR&#39;, &#39;SH.DYN.MORT&#39;, &#39;NY.GDP.PCAP.KD&#39;)

library(wbstats)

worldbank_data &lt;- read_csv(here::here(&#39;data&#39;,&#39;worldbank_data.csv&#39;))

countries &lt;-  wbstats::wb_cachelist$countries
</code></pre>

<div id="tidy-the-date" class="section level2">
<h2>Tidy the Data</h2>
<pre class="r"><code>hiv_tidy &lt;- hiv %>% 
  pivot_longer(!country, names_to = "year", values_to = "hiv")

life_expectancy_tidy &lt;- life_expectancy %>% 
  pivot_longer(!country, names_to = "year", values_to = "life_expectancy")

worldbank_tidy &lt;- worldbank_data %>% 
  mutate(year = as.character(date)) %>% 
  select(iso3c, country, year, SP.DYN.TFRT.IN,SE.PRM.NENR, SH.DYN.MORT, NY.GDP.PCAP.KD)

countries_tidy &lt;- countries %>% 
  select(iso3c, country, capital_city, region, income_level, lending_type)

#iso3c country codes for HIV and lifeExp data
hiv_lifeExp &lt;- full_join(life_expectancy_tidy, hiv_tidy, by = c("country","year"))

country_code &lt;- hiv_lifeExp %>% 
  select(country) %>% 
  distinct() %>% 
  pull()

countrycodes &lt;- country_code %>% 
  countrycode(
    origin = &#39;country.name&#39;,
    destination = &#39;iso3c&#39;)

countrycode_match &lt;- tibble(
  country = country_code, 
  iso3c = countrycodes)

hiv_lifeExp_tidy &lt;- left_join(hiv_lifeExp, countrycode_match, by = &#39;country&#39;)
  
#Check for primary keys before joining
hiv_lifeExp_tidy %>% 
  count(iso3c, year) %>% 
  filter(n>1) #0 rows means suitable as primary keys

worldbank_tidy %>% 
  count(iso3c, year) %>% 
  filter(n>1)

#Joining dataframes
wb_hiv_lifeExp &lt;- full_join(worldbank_tidy, hiv_lifeExp_tidy, by = c(&#39;iso3c&#39;,&#39;year&#39;))
wb_hiv_lifeExp_countries &lt;- left_join(wb_hiv_lifeExp, countries_tidy, by = &#39;iso3c&#39;)

#Tidy final data frame
wb_hiv_lifeExp_final &lt;- wb_hiv_lifeExp_countries %>% 
  select(-country.x,-country.y) %>% 
  mutate(year = as.Date(year, format = "%Y"),
         year = year(year)) %>% 
  filter(year %in% c(1960:2016)) %>% 
  rename(fertility_rate = SP.DYN.TFRT.IN,
         school_enrol = SE.PRM.NENR,
         mortality_rate = SH.DYN.MORT,
         gdpPercap = NY.GDP.PCAP.KD)

glimpse(wb_hiv_lifeExp_final)

</code></pre>
</div>

<div id="create-a-plot" class="section level3">
<p> What is the relationship between HIV prevalence and life expectancy? </p>
<pre class="r"><code>hiv_lifeExp_relationship &lt;- ggplot(
  data = wb_hiv_lifeExp_final,
  mapping=aes(
    x=hiv,
    y=life_expectancy, color = hiv))+
    geom_point()+
  geom_smooth()+
  labs(x = &#39;HIV Prevalence&#39;,
  y = &#39;Life Expectancy&#39;, color=&#39;HIV&#39;)+
  scale_y_continuous(expand = c(0, 0), limits = c(0, 100))+
  scale_x_log10()+
  facet_wrap(~region)

hiv_lifeExp_relationship 
</code></pre>
</div>

<div id="create-a-plot" class="section level3">
<p> What is the relationship between fertility rate and GDP per capita? </p>
<pre class="r"><code>fertilityGdp_relationship &lt;- ggplot(
  data=wb_hiv_lifeExp_final,
  mapping=aes(
    x=gdpPercap,
    y=fertility_rate, color = fertility_rate))+
    geom_point()+
  labs(x =&#39;GDP per Capita&#39;,
  y = &#39;Fertility Rate&#39;, color=&#39;Fertility Rate&#39;)+
  geom_smooth()+
  scale_x_log10()+
  facet_wrap(~region)

fertilityGdp_relationship
</code></pre>
</div>





</div>

                        </div>
                    </section>
            <!-- Disqus Inject -->
                
            </div>
            
        <!-- Footer -->
            
                <!-- Footer -->
    <footer id="footer">
        <div class="inner">
            <ul class="icons">
                
                    <li><a href="https://www.github.com" class="icon alt fa-github" target="_blank"><span class="label">GitHub</span></a></li>
                
                    <li><a href="https://www.linkedin.com" class="icon alt fa-linkedin" target="_blank"><span class="label">LinkedIn</span></a></li>
                
            </ul>
            <ul class="copyright">
                <li>&copy; Valeria Pavero</li>
                
                <li>Design:  <a href="https://www.html5up.net">HTML5 UP</a></li>
                
            </ul>
        </div>
    </footer>

            
        </div>

    <!-- Scripts -->
        <!-- Scripts -->
    <!-- jQuery -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>

    

    <!-- Main JS -->
    <script src="/js/main.js"></script>

    

    

    </body>
</html>
